#!/bin/bash

femacs() {
    filename=`find . -name $1`
    emacs $filename
}

switch-m2-settings() {
  cp ~/local/self/dotfiles/.m2settings/settings-$1.xml ~/.m2/settings.xml
}

jkill() {
  jps -v | grep $1 | awk '{print $1}' | xargs kill -9
}

gen-etags() {
  find . -name "*.java" -print | etags --append --member --output=`pwd`/TAGS -
}

hosts() {
    hostsdir=~/local/self/dotfiles/.hosts

    if [ -z $1 ]; then
	echo "hosts [ls|edit|hostsname]";
    else
        case $1 in
            ls)
               /bin/ls $hostsdir;;
            edit)
               vim $hostsdir/$2
               hosts $2;;
            cat)
               cat $hostsdir/$2;;
            *)
               cp $hostsdir/$1 /etc/hosts
               # show the first two lines of the
               # the hosts -- to check everything is right
               head -n 2 /etc/hosts;;
        esac
    fi
}

tcp_status() {
  netstat -n | awk '/^tcp/ {++state[$NF]} END {for(key in state) print key,"\t",state[key]}'
}

tcp_status_v() {
  netstat -n | awk '/^tcp/ {n=split($(NF-1),array,":");if(n<=2)++S[array[(1)]];else++S[array[(4)]];++s[$NF];++N} END {for(a in S){printf("%-20s %s\n", a, S[a]);++I}printf("%-20s %s\n","TOTAL_IP",I);for(a in s) printf("%-20s %s\n", a, s[a]);printf("%-20s %s\n","TOTAL_LINK",N);}'
}

alipay_svn_list() {
    svn st | sed 's/^M//g;s/^A  +//g;s/^A//g;s/^D//g;' | grep -v WebSofaStarter | grep -v sofa-test-config | grep -v AdcSessionFilter | grep -v MyGotoneConstants | grep -v projectile | grep -v 'adc-db.xml' | awk 'BEGIN {stat = "" } {stat = stat  $0;} END {print stat}'
}

redepoly-hiveservice() {
	$CATALINA_HOME/bin/shutdown.sh
	jps | grep Bootstrap | cut -d' ' -f1 | xargs kill -9
	rm -rf $CATALINA_HOME/webapps/HiveService*
	cd ~/local/alipay/hiveservice-bug/hiveservice
	mvn clean install -Dmaven.test.skip=true
	cp target/HiveService.war $CATALINA_HOME/webapps
	$CATALINA_HOME/bin/catalina.sh jpda start
}

. ~/local/self/dotfiles/.functions-storm
. ~/local/self/dotfiles/.functions-alibaba
